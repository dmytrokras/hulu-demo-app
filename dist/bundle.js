(()=>{"use strict";const t=e=>{const o=document.createElement(e.type);return e.classes?.length&&o.classList.add(...e.classes),e.attributes?.forEach((([t,e])=>{o.setAttribute(t,e)})),e.props?.forEach((([t,e])=>{o[t]=e})),e.text&&(o.innerText=e.text),e.children?.forEach((e=>{e instanceof Element?o.appendChild(e):o.appendChild(t(e))})),o},e=e=>{const o=t({type:"button",attributes:[["id","button1"]],text:e});return{button:o,focusElement:{direction:"none",focus:()=>o.classList.add("focused"),focusLost:()=>o.classList.remove("focused")}}},o=()=>t({type:"img",props:[["onerror",function(){this.src="src/assets/images/default-image.jpg"}]]}),s={LANDSCAPE_LARGE:{shift:!0,landscape:!0,width:640,height:360,outer_width:650,outer_height:370},BANNER_LARGE:{shift:!1,landscape:!0,width:1280,height:360,outer_width:1290,outer_height:370},LANDSCAPE_SMALL:{},PORTRAIT_LARGE:{shift:!0,landscape:!1,width:240,height:360,outer_width:250,outer_height:370},BANNER_ROW:{shift:!1,landscape:!0,width:640,height:360,outer_width:370,outer_height:370},PORTRAIT_SMALL:{},EXPANDABLE:{shift:!0,landscape:!1,width:240,height:360,outer_width:250,outer_height:370,expanded_width:640}},a=(e,o)=>{const s={imgError:!1},{landscape:a,width:i,height:n}=o,r=t({type:"img",attributes:[["src",a?e.landscapeImg:e.portraitImg]],props:[["onerror",function(){this.onerror=null,s.imgError=!0,this.src="src/assets/images/default-stil.gif"}]]});return{tile:t({type:"div",classes:["tile"],attributes:[["style",`width: ${i}px; height: ${n}px;`]],children:[r]}),img:r,state:s}};const i=(e,o)=>{const{outer_height:i,outer_width:n,shift:r}=s[o],c=[],u=e.items.map((t=>{const{domElement:e,focusElement:i}=function(t,e){return"EXPANDABLE"===e?((t,e)=>{const{tile:o,img:s,state:i}=a(t,e),{width:n,expanded_width:r}=e;return{domElement:o,focusElement:{direction:"none",focus:function(){o.classList.add("focused"),o.style.width=r+"px",document.appDataStore.heroModalInfo.heroImage=t.heroPosterImageURL,document.appDataStore.heroModalInfo.text=t.title,i.imgError?s.src="src/assets/images/default-anim.gif":s.src=t.landscapeImg},focusLost:function(){o.style.width=n+"px",o.classList.remove("focused"),document.appDataStore.heroModalInfo.heroImage="",document.appDataStore.heroModalInfo.text="",i.imgError?s.src="src/assets/images/default-stil.gif":s.src=t.portraitImg}}}})(t,s[e]):((t,e)=>{const{tile:o,img:s,state:i}=a(t,e);return{domElement:o,focusElement:{direction:"none",focus:function(){o.classList.add("focused"),document.appDataStore.heroModalInfo.heroImage=t.heroPosterImageURL,document.appDataStore.heroModalInfo.title=t.title,document.appDataStore.heroModalInfo.description=t.description,i.imgError&&(s.src="src/assets/images/default-anim.gif")},focusLost:function(){o.classList.remove("focused"),i.imgError&&(s.src="src/assets/images/default-stil.gif")}}}})(t,s[e])}(t,o);return c.push(i),e}));u.push({type:"div",classes:["carousel-delimiter"]});const d=t({type:"div",classes:["carousel-inner"],attributes:[["style",`height: ${i}px;`]],children:u});return{domElement:t({type:"div",attributes:[["style",`height: ${i+90}px;`]],children:[{type:"div",children:[{type:"h2",classes:["carousel-header"],text:e.title}]},{type:"div",classes:["carousel-container"],children:[d]}]}),focusElement:{direction:"row",loop:1,items:c,focusIndex:0,focus:function(){if(r){const t=this.focusIndex*n;d.style.transform=`translateX(${-t}px)`}},focusLost:function(){}}}},n=["LANDSCAPE_LARGE","PORTRAIT_LARGE","EXPANDABLE","BANNER_ROW","PORTRAIT_LARGE","BANNER_LARGE","EXPANDABLE","PORTRAIT_LARGE","EXPANDABLE","LANDSCAPE_LARGE","PORTRAIT_LARGE","EXPANDABLE","LANDSCAPE_LARGE","PORTRAIT_LARGE","EXPANDABLE"],r=(t,e)=>{const o={focusIndex:0,items:[],direction:"column",loop:0,focus:function(){let t=460*this.focusIndex;app.style.transform=`translateY(${-t}px)`}};t.forEach(((t,e)=>{const{domElement:s,focusElement:a}=i(t,n[e]);app.appendChild(s),o.items.push(a)})),e?document.appDataStore.focusManager.appendItemsToTree(o.items):document.appDataStore.focusManager.pushPage(o)},c=t=>({title:t.visuals.headline,premiereYear:t.entity_metadata.premiere_date.substring(0,4),description:t.visuals.body||"",genre:t.entity_metadata.genre_names.join(", "),rating:t.entity_metadata.rating?.code||"",landscapeImg:t.visuals.artwork.horizontal_tile.image.path+"&size=640x360&format=jpeg",heroPosterImageURL:t.visuals.artwork.horizontal_tile.image.path+"&size=1920x1080&format=jpeg",portraitImg:t.visuals.artwork.vertical_tile.image.path+"&size=200x300&format=jpeg"}),u=t=>({items:t.items.map(c),title:t.name,id:t.id});"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.onload=function(){window.scrollTo(0,0)},document.appDataStore={heroModalInfo:{visible:!1},focusManager:new class{constructor(){this._focusRoute=[],this.pageStack=[]}appendItemsToTree(t){if(!this.pageStack.length)throw new Error("Page stack is empty");this._focusTree.items.push(...t)}pushPage(t){this._focusTree=t,this._focusRoute=[],this.pageStack.push({focusTree:t,focusRoute:this._focusRoute}),this._focusFirstFocusableElement(t)}exitPage(){this.pageStack.pop(),this.pageStack.length&&(this._focusTree=this.pageStack.at(-1).focusTree,this._focusRoute=this.pageStack.at(-1).focusRoute)}_focusFirstFocusableElement(t){if(t&&(t?.focus(),this._focusRoute.push(t),t.items)){const e=t.items[t.focusIndex];this._focusFirstFocusableElement(e)}}getNavigationRoute(t,e){let o=this._focusRoute.length-1;const s=[];for(;o>=0;){let a=this._focusRoute[o];if(a.direction===t&&a.items?.length>0){let t=-1;if(e?a.focusIndex+1<a.items.length?t=a.focusIndex+1:1&a.loop&&(t=0):a.focusIndex>0?t=a.focusIndex-1:2&a.loop&&(t=a.items.length-1),-1!==t){for(s.push({element:a,action:"focus"}),a.focusIndex=t,a=a.items[t];a;)s.push({element:a,action:"focus"}),a=a.items?a.items[a.focusIndex]:null;return s.forEach((({element:t,action:e})=>{"focus"===e?(t.focus(),this._focusRoute.push(t)):(t.focusLost(),this._focusRoute.pop())})),!0}}s.push({element:a,action:"unfocus"}),o--}return!1}navigateLeft(){this.getNavigationRoute("row",!1)}navigateRight(){this.getNavigationRoute("row",!0)}navigateUp(){this.getNavigationRoute("column",!1)}navigateDown(){this.getNavigationRoute("column",!0)}}},document.addEventListener("keydown",(t=>{"ArrowRight"===t.key?document.appDataStore.focusManager.navigateRight():"ArrowLeft"===t.key?document.appDataStore.focusManager.navigateLeft():"ArrowUp"===t.key?document.appDataStore.focusManager.navigateUp():"ArrowDown"===t.key&&document.appDataStore.focusManager.navigateDown()}));const d=document.getElementById("modal"),l=document.getElementById("overlay"),{modalElement:h,modalFocusElement:p,modalImg:m,modalDescription:f,modalTitle:g}=(()=>{const s=e("▶ Play"),a=e("★ Rate"),i=e("➕ Add To List"),n=o(),r=t({type:"div",classes:["description"]}),c=t({type:"div",classes:["title"]}),u={type:"div",classes:["modal"],attributes:[["id","modal"]],children:[n,c,r,{type:"div",classes:["modal-buttons"],children:[s.button,a.button,i.button]}]};return{modalElement:t(u),modalImg:n,modalDescription:r,modalTitle:c,modalFocusElement:{direction:"row",loop:3,items:[s.focusElement,a.focusElement,i.focusElement],focusIndex:0,focus:function(){},focusLost:function(){}}}})();d.appendChild(h),document.addEventListener("keydown",(t=>{46!==t.keyCode&&8!==t.keyCode||document.appDataStore.heroModalInfo.visible&&(document.appDataStore.heroModalInfo.visible=!1,h.classList.remove("active"),l.classList.remove("active"),document.appDataStore.focusManager.exitPage()),"Enter"===t.key&&(document.appDataStore.heroModalInfo.visible||(document.appDataStore.heroModalInfo.visible=!0,h.classList.add("active"),l.classList.add("active"),document.appDataStore.focusManager.pushPage(p),m.src=document.appDataStore.heroModalInfo.heroImage,g.innerText=document.appDataStore.heroModalInfo.title,f.innerText=document.appDataStore.heroModalInfo.description,h.style.opacity=1))})),document.getElementById("app"),(async()=>{try{const t=await fetch("https://d1q0vy0v52gyjr.cloudfront.net/hub.json");if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const e=await t.json(),{processedRows:o,emptyRows:s}=(t=>{const e=[],o=[];return t.components.forEach((t=>{t.items.length?e.push(u(t)):t.id&&o.push(t.id)})),{processedRows:e,emptyRows:o}})(e);r(o),s.forEach((async t=>{const e=await fetch(`https://d1q0vy0v52gyjr.cloudfront.net/collections/${t}.json`);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const o=await e.json();r([u(o)],!0)}))}catch(t){console.error(t)}})()})();