(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var o=t.g.document;if(!e&&o&&(o.currentScript&&"SCRIPT"===o.currentScript.tagName.toUpperCase()&&(e=o.currentScript.src),!e)){var s=o.getElementsByTagName("script");if(s.length)for(var i=s.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=s[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();const e=t.p+"images/banner-fallback.jpg",o=t=>{var e,s,i,n;const a=document.createElement(t.type);return(null===(e=t.classes)||void 0===e?void 0:e.length)&&a.classList.add(...t.classes),null===(s=t.attributes)||void 0===s||s.forEach((([t,e])=>{a.setAttribute(t,e)})),null===(i=t.events)||void 0===i||i.forEach((([t,e])=>{a.addEventListener(t,e)})),t.text&&(a.innerText=t.text),null===(n=t.children)||void 0===n||n.forEach((t=>{t instanceof Element?a.appendChild(t):a.appendChild(o(t))})),a},s=t=>{const e=o({type:"button",text:t});return{button:e,focusElement:{direction:"none",loop:0,focusIndex:-1,focus:()=>e.classList.add("focused"),focusLost:()=>e.classList.remove("focused")}}},i=()=>o({type:"img",events:[["error",function(){this.src=e}]]});var n;!function(t){t.LANDSCAPE_LARGE="LANDSCAPE_LARGE",t.BANNER_LARGE="BANNER_LARGE",t.PORTRAIT_LARGE="PORTRAIT_LARGE",t.BANNER_ROW="BANNER_ROW",t.EXPANDABLE="EXPANDABLE"}(n||(n={}));const a={LANDSCAPE_LARGE:{shift:!0,landscape:!0,width:640,height:360,outer_width:650,outer_height:370},BANNER_LARGE:{shift:!1,landscape:!0,width:1280,height:360,outer_width:1290,outer_height:370},PORTRAIT_LARGE:{shift:!0,landscape:!1,width:240,height:360,outer_width:250,outer_height:370},BANNER_ROW:{shift:!1,landscape:!0,width:640,height:360,outer_width:370,outer_height:370},EXPANDABLE:{shift:!0,landscape:!1,width:240,height:360,outer_width:250,outer_height:370,expanded_width:640}},r=t.p+"images/tile-fallback-still.gif",c=t.p+"images/tile-fallback-animated.gif",l=(t,e)=>e.landscape?t.landscapeImg:t.portraitImg,u=(t,e,s,i)=>{const n={imgError:!1},{width:a,height:c}=e,u=o({type:"img",attributes:[["src",l(t,e)]],events:[["error",function(){this.onerror=null,n.imgError=!0,this.src=r}]]}),d=o({type:"div",classes:["tile"],attributes:[["style",`width: ${a}px; height: ${c}px;`]],children:[u]}),h=o({type:"div",classes:["tile-outer"],children:[d,{type:"div",text:t.title,classes:["title"]},{type:"div",text:t.subtitle,classes:["subtitle"]}]});return{domElement:h,focusElement:{loop:0,focusIndex:-1,direction:"none",focus:()=>s(h,d,u,n),focusLost:()=>i(h,d,u,n)}}};const d=(t,e)=>{const{outer_height:s,outer_width:i,shift:n}=a[e],l=[],d=t.items.map((t=>{const{domElement:o,focusElement:s}=function(t,e){return"EXPANDABLE"===e?((t,e)=>u(t,e,(function(o,s,i,n){o.classList.add("focused"),s.style.width=e.expanded_width+"px",document.appDataStore.heroModalInfo.selectedItem=t,n.imgError?i.src=c:i.src=t.landscapeImg}),(function(o,s,i,n){o.classList.remove("focused"),s.style.width=e.width+"px",document.appDataStore.heroModalInfo.selectedItem=null,n.imgError?i.src=r:i.src=t.portraitImg})))(t,a[e]):((t,e)=>u(t,e,(function(e,o,s,i){e.classList.add("focused"),document.appDataStore.heroModalInfo.selectedItem=t,i.imgError&&(s.src=c)}),(function(t,e,o,s){t.classList.remove("focused"),document.appDataStore.heroModalInfo.selectedItem=null,s.imgError&&(o.src=r)})))(t,a[e])}(t,e);return l.push(s),o}));d.push(o({type:"div",classes:["carousel-delimiter"]}));const h=o({type:"div",classes:["carousel-inner"],attributes:[["style",`height: ${s}px;`]],children:d}),p=o({type:"div",attributes:[["style",`height: ${s+90}px;`]],children:[{type:"div",children:[{type:"h2",classes:["carousel-header"],text:t.title}]},{type:"div",classes:["carousel-container"],children:[h]}]});return{domElement:p,focusElement:{direction:"row",loop:1,items:l,focusIndex:0,focus:function(){if(h.style.height="420px",p.style.height="520px",n){const t=this.focusIndex*i;h.style.transform=`translateX(${-t}px)`}},focusLost:function(){p.style.height="460px"}}}},h=[n.LANDSCAPE_LARGE,n.PORTRAIT_LARGE,n.EXPANDABLE,n.BANNER_ROW,n.PORTRAIT_LARGE,n.BANNER_LARGE,n.EXPANDABLE,n.PORTRAIT_LARGE,n.EXPANDABLE,n.LANDSCAPE_LARGE,n.PORTRAIT_LARGE,n.EXPANDABLE,n.LANDSCAPE_LARGE,n.PORTRAIT_LARGE,n.EXPANDABLE],p=(t,e=!1)=>{const o=document.getElementById("app"),s=[];t.forEach(((t,e)=>{const{domElement:i,focusElement:n}=d(t,h[e]);s.push(n),o.appendChild(i)}));const i={focusIndex:0,items:s,direction:"column",loop:0,focus:function(){const t=460*this.focusIndex;o.style.transform=`translateY(${-t}px)`},focusLost:()=>{}};e?document.appDataStore.focusManager.appendItemsToTree(i.items||[]):document.appDataStore.focusManager.pushPage(i)},m=t=>{var e;const o=[];return(null===(e=t.entity_metadata.rating)||void 0===e?void 0:e.code)&&o.push(t.entity_metadata.rating.code),t.entity_metadata.genre_names.length&&o.push(t.entity_metadata.genre_names.join(", ")),t.entity_metadata.premiere_date&&o.push(t.entity_metadata.premiere_date.substring(0,4)),o.join(" · ")},f=t=>{var e;return{title:t.visuals.headline,premiereYear:t.entity_metadata.premiere_date.substring(0,4),description:t.visuals.body||"",genre:t.entity_metadata.genre_names.join(", "),rating:(null===(e=t.entity_metadata.rating)||void 0===e?void 0:e.code)||"",subtitle:m(t),landscapeImg:t.visuals.artwork.horizontal_tile.image.path+"&size=640x360&format=jpeg",heroPosterImageURL:t.visuals.artwork.horizontal_tile.image.path+"&size=1280x720&format=jpeg",portraitImg:t.visuals.artwork.vertical_tile.image.path+"&size=200x300&format=jpeg"}},g=t=>({items:t.items.map(f),title:t.name,id:t.id});var E=function(t,e,o,s){return new(o||(o=Promise))((function(i,n){function a(t){try{c(s.next(t))}catch(t){n(t)}}function r(t){try{c(s.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((s=s.apply(t,e||[])).next())}))};"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.onload=function(){window.scrollTo(0,0)},document.appDataStore={heroModalInfo:{visible:!1},focusManager:new class{constructor(){this._focusRoute=[],this.pageStack=[]}appendItemsToTree(t){var e;if(!this.pageStack.length)throw new Error("Page stack is empty");if(!(null===(e=this._focusTree)||void 0===e?void 0:e.items))throw new Error("Focus tree is not initialized.");this._focusTree.items.push(...t)}pushPage(t){this._focusTree=t,this._focusRoute=[],this.pageStack.push({focusTree:t,focusRoute:this._focusRoute}),this._focusFirstFocusableElement(t)}exitPage(){if(this.pageStack.pop(),this.pageStack.length>0){const t=this.pageStack.at(-1);this._focusTree=t.focusTree,this._focusRoute=t.focusRoute}else this._focusTree=void 0,this._focusRoute=[]}_focusFirstFocusableElement(t){if(t&&(t.focus(),this._focusRoute.push(t),t.items)){const e=t.items[t.focusIndex];this._focusFirstFocusableElement(e)}}getNavigationRoute(t,e){var o;let s=this._focusRoute.length-1;const i=[];for(;s>=0;){let n=this._focusRoute[s];if(n.direction===t&&(null===(o=n.items)||void 0===o?void 0:o.length)){let t=-1;if(e?n.focusIndex+1<n.items.length?t=n.focusIndex+1:1&n.loop&&(t=0):n.focusIndex>0?t=n.focusIndex-1:2&n.loop&&(t=n.items.length-1),-1!==t){for(i.push({element:n,action:"focus"}),n.focusIndex=t,n=n.items[t];n;)i.push({element:n,action:"focus"}),n.items&&!n.items[n.focusIndex]||(n=n.items?n.items[n.focusIndex]:null);return i.forEach((({element:t,action:e})=>{"focus"===e?(t.focus(),this._focusRoute.push(t)):(t.focusLost(),this._focusRoute.pop())})),!0}}i.push({element:n,action:"unfocus"}),s--}return!1}navigateLeft(){this.getNavigationRoute("row",!1)}navigateRight(){this.getNavigationRoute("row",!0)}navigateUp(){this.getNavigationRoute("column",!1)}navigateDown(){this.getNavigationRoute("column",!0)}}},document.addEventListener("keydown",(t=>{const{focusManager:e}=document.appDataStore;"ArrowRight"===t.key?e.navigateRight():"ArrowLeft"===t.key?e.navigateLeft():"ArrowUp"===t.key?e.navigateUp():"ArrowDown"===t.key&&e.navigateDown()}));const v=document.getElementById("modal"),R=document.getElementById("overlay"),{modalElement:y,modalFocusElement:_,modalImg:A,modalDescription:w,modalTitle:L}=(()=>{const t=s("▶ Play"),e=s("★ Rate"),n=s("➕ Add To List"),a=i(),r=o({type:"div",classes:["description"]}),c=o({type:"div",classes:["title"]}),l={type:"div",classes:["modal"],children:[a,c,r,{type:"div",classes:["modal-buttons"],children:[t.button,e.button,n.button]}]};return{modalElement:o(l),modalImg:a,modalDescription:r,modalTitle:c,modalFocusElement:{direction:"row",loop:3,items:[t.focusElement,e.focusElement,n.focusElement],focusIndex:0,focus:function(){},focusLost:function(){}}}})();v.appendChild(y),document.addEventListener("keydown",(t=>{const{heroModalInfo:e,focusManager:o}=document.appDataStore;"Delete"!==t.key&&"Backspace"!==t.key||e.visible&&(e.visible=!1,y.classList.remove("active"),R.classList.remove("active"),o.exitPage()),"Enter"===t.key&&!e.visible&&e.selectedItem&&(e.visible=!0,y.classList.add("active"),R.classList.add("active"),o.pushPage(_),A.src=e.selectedItem.heroPosterImageURL||"",L.innerText=e.selectedItem.title||"",w.innerText=e.selectedItem.description||"",y.style.opacity="1")})),E(void 0,void 0,void 0,(function*(){try{const t=yield fetch("https://d1q0vy0v52gyjr.cloudfront.net/hub.json");if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const e=yield t.json(),{processedRows:o,emptyRows:s}=(t=>{const e=[],o=[];return t.components.forEach((t=>{t.items.length?e.push(g(t)):t.id&&o.push(t.id)})),{processedRows:e,emptyRows:o}})(e);p(o),s.forEach((t=>E(void 0,void 0,void 0,(function*(){const e=yield fetch(`https://d1q0vy0v52gyjr.cloudfront.net/collections/${t}.json`);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const o=yield e.json();p([g(o)],!0)}))))}catch(t){console.error(t)}}))})();